(this["webpackJsonpturnips-tracker"]=this["webpackJsonpturnips-tracker"]||[]).push([[0],{150:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(10),l=a.n(o),i=(a(54),a(28)),s=a(29),c=a(5),u=a(31),p=a(30);a(55);var d=a(17),f=a(27),h=a.n(f);var m=function(){var e=r.a.createRef(),t=r.a.createRef(),a=r.a.createRef();return d.b.global.maintainAspectRatio=!1,r.a.createElement("div",null,r.a.createElement(v,{tableRef:e,priceChartRef:t,profitChartRef:a}),r.a.createElement("div",{style:{display:"none",position:"relative",height:"40vh",width:"95vw"}},r.a.createElement(d.a,{ref:t,data:{}})),r.a.createElement("div",{style:{display:"none",position:"relative",height:"40vh",width:"95vw"}},r.a.createElement(d.a,{ref:a,data:{}})),r.a.createElement(b,{ref:e}))},v=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={tableRef:e.tableRef,priceChartRef:e.priceChartRef,profitChartRef:e.profitChartRef},n.useSample=n.useSample.bind(Object(c.a)(n)),n.handleChange=n.handleChange.bind(Object(c.a)(n)),n.parseAndOpenJson=n.parseAndOpenJson.bind(Object(c.a)(n)),n.reportError=n.reportError.bind(Object(c.a)(n)),n}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("form",null,r.a.createElement("label",{htmlFor:"turnips-file"},"Open Turnips Data: "),r.a.createElement("input",{type:"file",id:"turnips-file",onChange:this.handleChange,title:"Open Turnips Data"}),r.a.createElement("button",{onClick:this.useSample},"Open Sample"))}},{key:"useSample",value:function(e){var t=this;fetch("/turnips-tracker/sample.json").then((function(e){if(e.ok)return e.text();t.reportError("Could not get sample data: ".concat(e.status," ").concat(e.statusText))})).then(this.parseAndOpenJson),e.preventDefault()}},{key:"handleChange",value:function(e){var t=this,a=e.target.files[0];if(a)if(a instanceof Blob){var n=new FileReader,r=this.state.tableRef.current;n.onload=function(e){var a=n.result;console.assert("string"===typeof a,"readAsText did not return a String result but a %s of value %s",a.constructor.name,a),t.parseAndOpenJson(a)},n.onerror=function(e){var t=n.error;console.error("Error occurred when reading turnips data file: %s",t),r.setState({errorMessage:"could not read file: ".concat(t.message)})},n.readAsText(a),e.preventDefault()}else console.log("Not a Blob, but a %s",a.constructor.name)}},{key:"parseAndOpenJson",value:function(e){try{var t=JSON.parse(e);this.openJson(t)}catch(n){console.error("Error occurred when opening turnips data: %s",n);var a="more details in the console";n instanceof SyntaxError&&(a=n.message),this.reportError(a)}}},{key:"openJson",value:function(e){var t=this.state.priceChartRef.current,a=this.state.profitChartRef.current;this.state.tableRef.current.setState({entries:e}),t.chartInstance.data=function(e){var t=[],a=[],n=[];function r(e,t,a){return{label:e,data:t,pointRadius:4,pointHoverRadius:6,borderWidth:4,spanGaps:!0,pointBackgroundColor:a,backgroundColor:a,borderColor:a}}return e.forEach((function(e){var r=e.price;if(null!=e.sold){var o="morning"===e.half?"am":"pm";t.push(e.date+o),a.push(r),n.push(null)}else t.push(e.date),a.push(null),n.push(r)})),{labels:t,datasets:[r("Selling Price",a,"rgba(30, 144, 255, 0.2)"),r("Buying Price",n,"rgba(255, 215, 0, 0.2)")],options:{scales:{yAxes:[{stacked:!0}]}}}}(e),t.chartInstance.update(),l.a.findDOMNode(t).parentNode.style.removeProperty("display"),a.chartInstance.data=function(e){var t=[],a=[],n=0,r=0;e.sort(g).forEach((function(e){if(null!=e.sold){if(0===t.length)return;r+=e.sold*e.price}else 0!==t.length&&a.push(r-n),t.push(e.date),n=e.bought*e.price,r=0})),(n>0||r>0)&&a.push(r-n);return{labels:t,datasets:[{label:"Profit",data:a}]}}(e),a.chartInstance.update(),l.a.findDOMNode(a).parentNode.style.removeProperty("display")}},{key:"reportError",value:function(e){this.state.tableRef.current.setState({errorMessage:e})}}]),a}(r.a.Component),b=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){if(!this.state)return r.a.createElement("p",null,"No Turnips Data Loaded");var e=this.state.errorMessage;if(e)return r.a.createElement("p",null,"Error when reading the turnips data: ",e);var t=this.state.entries.sort(g).map((function(e){return function(e){var t,a,n=e.bought,o=e.sold,l=e.price;if(null!=n)if(a=n.toLocaleString(),n<=0)t="Bought none";else if(null!=l&&l>0){var i=(l*n).toLocaleString();t="Bought ".concat(a," for ").concat(i," (").concat(l,"/unit)")}else t="Bought ".concat(a," for an unknown price");else if(null!=o)if(a=o.toLocaleString(),o<=0)t="Sold none";else if(null!=l&&l>0){var s=(l*o).toLocaleString();t="Sold ".concat(a," for ").concat(s," (").concat(l,"/unit)")}else t="Sold ".concat(a," for an unknown price");else a="unknown",t="No data available";return r.a.createElement("tr",{key:e.date+"-"+e.half},r.a.createElement("td",null,e.date," (",(c=e.date,h()(c,"yyyy-MM-DD").format("dddd")),") ",e.half),r.a.createElement("td",null,l),r.a.createElement("td",null,a),r.a.createElement("td",null,t));var c}(e)}));return r.a.createElement("table",{id:"turnips-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Date"),r.a.createElement("th",null,"Price"),r.a.createElement("th",null,"Bought / Sold"),r.a.createElement("th",null,"Detail"))),r.a.createElement("tbody",null,t))}}]),a}(r.a.Component);function g(e,t){return e.date===t.date?"morning"===e.half&&"afternoon"===t.half?-1:1:function(e,t){if(!e||!t||"string"!==typeof e||"string"!==typeof t)return Number.MIN_SAFE_INTEGER;if(e===t)return 0;var a=e.split("-"),n=t.split("-");if(3!==a.length||3!==n.length)return Number.MIN_SAFE_INTEGER;for(var r=0;r<3;r++){var o=parseInt(a[r]),l=parseInt(n[r]);if(isNaN(o)||isNaN(l))return Number.MIN_SAFE_INTEGER;if(o!==l)return o<l?-1:1}return 0}(e.date,t.date)}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(m,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},49:function(e,t,a){e.exports=a(150)},54:function(e,t,a){},55:function(e,t,a){}},[[49,1,2]]]);
//# sourceMappingURL=main.f7b0a818.chunk.js.map